<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-45596498-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>Write a CGI program | Gianluca Ciccarelli</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Today I wanted to make some experiments with CGI on my newly-installed Ubuntu 16.04. There are a few steps to take before starting to experiment, and I’m writing them down here in case anyone else wan">
<meta property="og:type" content="article">
<meta property="og:title" content="Write a CGI program">
<meta property="og:url" content="https://www.gergel.im/2016/06/05/write-a-cgi-program/index.html">
<meta property="og:site_name" content="Gianluca Ciccarelli">
<meta property="og:description" content="Today I wanted to make some experiments with CGI on my newly-installed Ubuntu 16.04. There are a few steps to take before starting to experiment, and I’m writing them down here in case anyone else wan">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2016-06-05T13:25:00.000Z">
<meta property="article:modified_time" content="2020-08-15T09:14:02.640Z">
<meta property="article:author" content="Gianluca Ciccarelli">
<meta property="article:tag" content="cgi">
<meta property="article:tag" content="apache">
<meta property="article:tag" content="ubuntu">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@increatore">
  
    <link rel="alternate" href="/atom.xml" title="Gianluca Ciccarelli" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Gianluca Ciccarelli</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/index.html">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/now.html">Now</a>
        
          <a class="main-nav-link" href="/blog">Blog</a>
        
          <a class="main-nav-link" href="/fiction.html">Fiction</a>
        
          <a class="main-nav-link" href="/reads.html">Reads</a>
        
          <a class="main-nav-link" href="/software.html">Software</a>
        
          <a class="main-nav-link" href="/about-site.html">Website</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="//github.com/sturmer">GitHub</a>
        
          <a class="main-nav-link" href="/about-me.html">Me</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Ricerca"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.gergel.im"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-write-a-cgi-program" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/05/write-a-cgi-program/" class="article-date">
  <!-- Use `hideDate: true` in a .md file to hide the date -->
  
  <time datetime="2016-06-05T13:25:00.000Z" itemprop="datePublished">2016-06-05</time>
  
</a>

    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Write a CGI program
    </h1>
  

        
          [459 words]
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Today I wanted to make some experiments with CGI on my newly-installed Ubuntu 16.04. There are a few steps to take before starting to experiment, and I’m writing them down here in case anyone else wants to try something similar.</p>
<a id="more"></a>

<h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><ol>
<li><code>sudo a2enmod cgi</code></li>
<li>Write program, build, copy it into <code>/usr/lib/cgi-bin</code></li>
<li><code>sudo chmod a+x &lt;yourprogram&gt;</code></li>
<li>Go to <code>localhost/cgi-bin/&lt;yourprogram&gt;</code></li>
<li>Enjoy</li>
</ol>
<p>Make sure your first line of output is <code>Content-type: text/plain\n\n</code>, and you should be fine.</p>
<h2 id="Configure-Apache"><a href="#Configure-Apache" class="headerlink" title="Configure Apache"></a>Configure Apache</h2><p>On Ubuntu, the main configuration for apache lies in the directory <code>/etc/sites-available/000-default.conf</code>. The principle is that you have a bunch of configurations available, and a subset of them that are also <em>enabled</em>. Enabling a configuration means simply that a symlink to some file in the <code>sites-available</code> gets created in <code>sites-enabled</code>. Rather than doing this manually, the Apache documentation encourages to use a command, <code>a2enconf</code>. Which, well, does exactly that: creates the symlink.</p>
<p>In the same spirit, you use a command <code>a2enmod</code> to enable modules. Point is, the CGI module is not enabled by default; to turn it on, all you need is one <code>sudo a2enmod cgi</code> command away. Note: you might receive a warning, saying that you are using a multithreaded MPM, in which case this command will be automatically translated into <code>sudo a2enmod cgid</code> (notice the final <em>d</em>).</p>
<p>When you enable a module, you are asked to restart (not reload) the server:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service apache2 restart</span><br></pre></td></tr></table></figure>

<h2 id="Write-the-program"><a href="#Write-the-program" class="headerlink" title="Write the program"></a>Write the program</h2><p>The program needs to respect the directions given in the official <a target="_blank" rel="noopener" href="http://www.ietf.org/rfc/rfc3875">RFC</a>. What? Too long, you say? Well, to get started, you only need to make sure to declare, as the first line of your output, the content type you are about to produce, followed by a blank line. According to HTTP, what you are doing is providing an HTTP Response header, which is the only one you have to provide explicitly. You then need a blank line that indicates that you are done with the response headers; what comes next is then the Response body.</p>
<p>So for example, here is a silly <em>Hello, world</em> program:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Content-type: text/plain\n\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello, world!\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Run-it"><a href="#Run-it" class="headerlink" title="Run it!"></a>Run it!</h2><p>Build this program and save the executable in the directory <code>/usr/lib/cgi-bin/</code>. This path is defined in one of the enabled configurations (usually under <code>/etc/apache2/conf-enabled/</code>), which is aptly named <code>serve-cgi-bin.conf</code>. Make sure to give permissions to execute the program (<code>sudo chmod a+x &lt;yourfile&gt;</code> should suffice). At this point, just open your browser at <code>localhost/cgi-bin/hello</code> (where <code>hello</code> is the name you actually gave too your executable program), and you should be able to see a page displaying the friendly greeting.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.gergel.im/2016/06/05/write-a-cgi-program/" data-id="ckj649hq1003x2aptdekf3nbn" class="article-share-link">Condividi</a>
      
        <a href="https://www.gergel.im/2016/06/05/write-a-cgi-program/#disqus_thread" class="article-comment-link">Commenti</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apache/" rel="tag">apache</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cgi/" rel="tag">cgi</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/01/switching-to-https/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Più recente</strong>
      <div class="article-nav-title">
        
          Switching gergel.im to https
        
      </div>
    </a>
  
  
    <a href="/2016/06/05/dtors-not-always-called-when-exceptions-are-thrown/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Meno recente</strong>
      <div class="article-nav-title">Destructors are not always called in case of exceptions!</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Gianluca Ciccarelli<br>
      Costruito con <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/index.html" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/now.html" class="mobile-nav-link">Now</a>
  
    <a href="/blog" class="mobile-nav-link">Blog</a>
  
    <a href="/fiction.html" class="mobile-nav-link">Fiction</a>
  
    <a href="/reads.html" class="mobile-nav-link">Reads</a>
  
    <a href="/software.html" class="mobile-nav-link">Software</a>
  
    <a href="/about-site.html" class="mobile-nav-link">Website</a>
  
    <a target="_blank" rel="noopener" href="//github.com/sturmer" class="mobile-nav-link">GitHub</a>
  
    <a href="/about-me.html" class="mobile-nav-link">Me</a>
  
</nav>
    
<script>
  var disqus_shortname = 'www-gergel-im-blog';
  
  var disqus_url = 'https://www.gergel.im/2016/06/05/write-a-cgi-program/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>